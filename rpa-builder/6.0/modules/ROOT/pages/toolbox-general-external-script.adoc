include::rpa-home::partial$pending-review.adoc[]
//This one is not in RPA Builder, confirm if we need to include it

= External Script

The _MuleSoft_ script engine utilizes the automation scripting
language _AutoIT_. With the _External Script_ _Action Step,_ you can
execute any _AutoIT_ code you like within a _Workflow_. This way, you
can handle all additional requirements that cannot be implemented into a
_Workflow_ using the regular built-in _Action Steps_.

You can find the AutoIT and STC API documentation via the Help button at
the top right of the wizard. Alternatively, these files are located in
your installation folder in _[Install Dir]_\ServiceTracerClient\bin\

Unlike all other _Action Steps_, the _External Script_ _Action Step_ can
be integrated into the entire _Workflow_, not just a _Transaction_.

== Properties

* *File Path* (_Properties_ grid only): The path to the external script
file is displayed here (not editable)
* *Script Creation Date* (_Properties_ grid only): Date the file
containing the external script was created (not editable)
* *Script Modification Date* (_Properties_ grid only): Date the file
containing the external script was last modified (not editable)

== Wizard

The wizard contains a text editor featuring various options.

//image:media\image1.png[image,width=22,height=21]
*Open Script* opens an existing script for editing

//image:media\image2.png[image,width=24,height=23]
*Cut* removes the selected text

//image:media\image3.png[image,width=21,height=22]
*Copy* copies the selected text

//image:media\image4.png[image,width=19,height=23]
*Paste* inserts the previously cut or copied text

//image:media\image5.png[image,width=22,height=21]
*Undo* reverses the last step

//image:media\image6.png[image,width=25,height=22]
*Redo* reverses the last undo step

//image:media\image7.png[image,width=25,height=25]
*Find* searches for the text entered in the box
//image:media\image8.png[image,width=33,height=27]
//and image:media\image9.png[image,width=34,height=24] moves the cursor to the previous and next result found respectively.

*Decrease Indent* reduces how far the selected text is positioned from the margin

*Increase Indent* moves the selected text further from the margin

//image:media\image10.png[image,width=23,height=26]
*Comment out selected lines* ignores the selected lines

//image:media\image11.png[image,width=25,height=22]
*Uncomment selected lines* ensures the selected lines of text are not ignored

*Font Size* changes the size of the text

*Insert script variable* allows a value from a variable in the script to
be added to a local variable. The name of the local variable matches
that of the script variable with a Safe_ before it. (The original name
must be used if a value from a script variable is to be changed.)

Use *Insert Measurement Point* to insert a measurement point that can be
used for reporting in the external script. You have two options here:

* You can
//use image:media\image12.png[image,width=158,height=20] to
insert timers or checkpoints.
//The following window is opened:
+
//image:media\image13.png[Ein Bild, das Text enthält. Automatischgenerierte Beschreibung,width=248,height=105]
Under *Type*, select whether you want to insert a timer or a checkpoint.
The *ID* is assigned automatically. When you click OK, the measurement
point is added to the drop-down list.
+
//image:media\image14.png[Ein Bild, das Text enthält. Automatischgenerierte Beschreibung,width=246,height=114]
+
//Use image:media\image15.png[image,width=24,height=23] to insert themeasurement points into the script.
* You can
//use image:media\image16.png[image,width=220,height=19] to
import the measurement points using a csv list.
//The following dialog is opened:
+
//image:media\image17.png[Ein Bild, das Text enthält. Automatischgenerierte Beschreibung,width=199,height=125]
Enter the *CSV file path* and the *Type* of the measurement points.
+
Also specify the *Column* you want to read. It gives the measurement
point a name. The first column contains the index, “1”.
+
You can also select which *Separator* you want to use. The default value is comma.
+
Select *Skip header* if you want to skip the first row, which often
contains the header information.

A maximum of 100 rows is imported. If this value is exceeded, the first
100 rows are imported.

_Insert Outbound Variable_ is used to define specific Outbound Variables
for an “External Script”. The defined variables can be inserted directly
into the code.
//Simply click the image:media\image18.png[image,width=23,height=21] icon to do this.
//The other buttons allow you to find the variable in the script, to edit it or to delete it.

//image:media\image19.png[Ein Bild, das Text enthält. Automatischgenerierte Beschreibung,width=604,height=359]

If you want to define a new variable, you can do this by clicking the
_Add Outbound Variable_ button. A wizard then opens. Give the new
variable a name and assign a type to it. In addition, set the _Scope_ to
specify whether this variable is only visible within the _Transaction_
or globally throughout the whole _Workflow_.

//image:media\image20.png[Ein Bild, das Text enthält. Automatischgenerierte Beschreibung,width=286,height=148]

You can define many different types of variable in an _External Script_:

* *Integer* Positive or negative whole number
* *Text* Alphanumeric string (text)
* *Bool* Boolean value (True/False)
* *Floating-point* Floating-point numbers
* *Coordinate* Denotes a point on the screen and is described by an XY
coordinate pair. The X coordinates increase from left to right; Y
coordinates increase from top to bottom. The coordinate \{0;0} is the
top-left corner of the screen.

////
== Examples

*Example 1: Copy Trace Directory to Network Drive*

By default, when not using the _TraceManagement Server_ for automated
_Workflow_ execution, the _ServiceTracer® Client_ stores information
logs and error screenshots in the
Shared Documents\ServiceTracerCommon\Robot\Trace\ folder.

A customer wanted to automatically copy this information from all
__ServiceTracer® Client__s to a mapped network drive, so it can be
monitored at a central place without the need to connect to the actual
PC. To achieve this, the following external script was developed:

local $Copy_TargetDir = ‘Z:\’ & @computername & ‘\’

; declare parameter $Copy_TargetDir and fill it with a path consisting
of the network

; drive name and a folder name the folder name is automatically set to
the name of the

; PC ServiceTracer is running on by using @computername

FileCopy($trace_dir,$Copy_TargetDir,9)

; copy the content of the local Trace folder to the target folder using
the flag 9

; creates the target directory if it does not already exists and
overwrites files that

; are already existing

This external script would then be used at the end of a _Workflow_.

*Example 2: Creating your own Parameters and Variables:*

A customer wanted to change the IP Address for a _Ping_ _Action Step_
without using RPA Builder. The result was this simple external
script:

global $PingTarget = "127.0.0.1"

; declare parameter $PingTarget and fill it with an IP Address

You can use this variable subsequently with our inline variable system
(see Section link:#InlineVariables[Inline Variables]), so in this
example, enter \{$PingTarget} in the _Destination Host_ property of the
_Ping_ _Action Step_:

image:media\image21.png[image,width=176,height=26]

To display user-defined variables in the _Workflow Debugger_, call the
function StcDbgSetWatch( $VarDispName, $Value), where $VarDispName is a
description of the displayed variable name or simply the name itself.
$Value has to be replaced by the variable which should be displayed. In
the previous example, this could be StcDbgSetWatch ( "Ping Target",
_$PingTarget_).

== StcFuncLib and StcUserApi

For more in-depth, tasks, there is an API for part of the script code
called StcFuncLib. StcFuncLib takes responsibility for the control and
administration of the script run when the Workflow is executed in the
form of the generated script code. The StcUserApi with its set of AutoIt
functions is provided to access data and functions of StcFuncLib. The
documentation for these functions is provided in the Stc help file,
which is always installed with Workflow Studio.

image:media\image22.png[Ein Bild, das Text enthält. Automatisch
generierte Beschreibung,width=320,height=300]

To open the help file, you can either use the Windows Start menu

image:media\image23.png[Ein Bild, das Text, Elektronik, Screenshot
enthält. Automatisch generierte Beschreibung,width=167,height=224]

or the Help button on the upper right, in the wizard of the _External
Script_ Action Step.

image:media\image24.png[Ein Bild, das Text enthält. Automatisch
generierte Beschreibung,width=318,height=109]
