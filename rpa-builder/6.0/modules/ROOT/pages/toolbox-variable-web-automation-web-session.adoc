include::rpa-home::partial$pending-review.adoc[]

== Web Session

You use a _Web Session_ to open and close the browser window in which
all the _Web Automation_ elements contained therein interact.

The link:#AS_WebSession_WebSessionID[web session ID] gives you the
option of reusing a session that has already begun in a different web
session.

There are four different _Web Session_ Action Steps, which you can each
use to open a different browser:

*Chrome*

*Firefox*

*Internet Explorer*

*Please note:* When using Microsoft Internet Explorer, make sure that
the Enable Protected Mode setting is the same for all security zones
(either all on or all off). The Ignore IE Protected Mode option must not
be enabled. Furthermore, the Zoom Level must be set to 100% for the Web
Automation Plugin to work. Otherwise the operation is not possible.

*MS Edge*

Currently, only the previous version of MS Edge is supported. The new,
Chromium-based version will be used in an upcoming version of Workflow
Studio, as soon as Selenium supports this type. Therefore, we suggest
using the other web session browsers initially for new projects.

In the following, we will always describe the shared properties of the
individual web sessions before delving into the differences.

=== Properties

*Common:*

* *Hide Command Prompt* hides the web driver’s command prompt (default).
Can be displayed again for diagnostic purposes.
* *Initial URL* Enter a URL here. The browser will be initially launched
with this page. Default and recommend: about: blank
* *Keep out mouse* If selected, at the start of the _Web session_ the
mouse will be moved to the corner defined in the _Move mouse to_
property. This is useful if you want to avoid triggering hover effects
on a website accidentally.
* *Move mouse to* Defines where the mouse pointer should be moved to if
_Keep out mouse_ is enabled
* *Repeat keep out mouse* If selected, the mouse will be moved to the
corner defined in the _Move mouse to_ property before each step within
the _Web Session_. This is useful if you want to avoid triggering hover
effects on a website accidentally.
* *Script Timeout [sec]* Maximum waiting time in seconds before the
internal scripting of the web driver is aborted. You should only change
this value if MuleSoft Support advises you to do so.
* *Start maximized* Decide if the browser window should start maximized
* *Webdriver Retries* Number of retries to establish a successful web
driver connection.
* *Webdriver Timeout [sec]* After the assigned time a Webdriver command
will be aborted.

*Options for Chrome*

* *Additional Chrome arguments* (_Properties_ grid only): Define
command-line parameters for _Google Chrome_. By default,
_disable-translate_ is set. This disables the automatic translation bar
feature of _Google Chrome_ because it may hinder _Workflow_ execution.
Only applicable if _Browser_ is set to _Google Chrome._
* *Alternative User Agent String* (_Properties_ grid only): Override the
default User Agent string for Google Chrome.
* *_Disable Unpacked Extensions support If you want to prevent the use
of unpacked extensions in the Chrome browser, select this checkbox._*
The communication between Webdriver and Chrome is restricted as a
result. This usually does not have any effect on the Webdriver functions
we use.
* *Verbose Logging*

*Options for Firefox*

* *Accept untrusted certificates* (_Properties_ grid only): If set,
Firefox will automatically accept untrusted certificates.
* *Additional profile extensions* (_Properties_ grid only): Use this
setting to add additional Firefox configuration settings. One or more
settings have to be in the form of:
<config_1>;<type>;<value-1>;<config_n>;<type>;<value_n> +
Example: intl.accept_languages;string;no,en-us,en Valid types are int,
bool, and string. Values containing ; must be enclosed in double
quotation marks "
* *Alternative user agent string* (_Properties_ grid only): Override the
default User Agent string for Firefox.
* *Enable native events* (_Properties_ grid only): Enable this option if
you are having trouble with mouse hover during execution.
* *Port* (_Properties_ grid only): Defines the TCP/IP listener port
number used for Firefox for communication between Firefox and a
_ServiceTrace®_ robot. If set to '-1' an ephemeral port number is used
(and may also be used for all concurrent _MultiTracer_ instances). To
ensure optimal operation in a _MultiTracer_ environment, a value of '0'
(default) is recommended. +
In this case, the port used is calculated by the following function:
_port = TSID * 4 + 45000_ (TSID is the current Terminal Session ID). To
choose a base value other than 45000, a value greater than '0' must be
assigned.
* *Prefer 64Bit Webdriver* Select your preferred bitness here. The
program tries the other one in case the preferred one is not available
and generates a warning.
* *Profile name* (_Properties_ grid only): Start Firefox with a specific
profile. This profile must be created beforehand on the executing agent
using the Firefox profile manager.

*Options for Internet Explorer*

* *Additional options* Select this option for additional settings.
* *Alternative User Agent String* You can enter an alternative user
agent string here.
* *Clear browser cache* (_Properties_ grid only): Clear Internet
Explorer cache before starting the session. Note that this will also
influence all other _MultiTracer_ sessions for the current user.
* *Disable IE11 Check/Repair* This option disables the IE11’s
compatibility check and repair. Change this setting after being advised
by MuleSoft Support only.
* *Enable detailed logging* (_Properties_ grid only): Add more
information to the _Internet Explorer_ session log file. Only applicable
if _Browser_ is set to _Internet Explorer_.
* *Enable Native Events* (_Properties_ grid only): Using native events
is the default and works best in most cases. If disabled, only
_JavaScript_ events will be emulated and buttons may not be pressed
correctly. Only applicable if _Browser_ is set to _Internet Explorer_.
* *Enable Persistent Hover* (_Properties_ grid only): This mode was
introduced with newer versions of _Selenium_ (>2.15.1). This mode will
enhance the mouse hover stability in most cases, but unfortunately not
for _SharePoint_ portal applications. If you have trouble with hover
effects, try enabling this option. Only applicable if _Browser_ is set
to _Internet Explorer_.
* *Ignore IE Protected Mode* (_Properties_ grid only): If the _Internet
Explorer_ security zones have different protected mode settings,
navigating from one zone to another will usually make the browser
unresponsive and _Web Automation_ will not work anymore. By default, the
_Internet Explorer_ session will check if the zones have different
protected mode settings and will not start if they do. If you enable
this option (for example, because it is your company's group policy to
prohibit changes to the _Protected Mode_ settings), you must make sure
that the entire Workflow takes place in the same zone!
* *Ignore IE Zoom Level* _(Properties_ grid only): Th__e Internet
Explorer__ Session will only work i__f Zoom Level__ is set t__o 100%.__
By default, a check is made to confirm the setting i__s 100%__; if it is
not, the session will not start. However the check sometimes fails even
though th__e Zoom Level__ is set t__o 100%__. Enable this option to
ignore th__e Zoom Level__ in such cases. Only applicable i__f Browser__
is set t__o Internet Explorer__.
* *Log file location* (_Properties_ grid only): You may specify a
separate path for the _Internet Explorer_ session to write its log file
to. By default, the log file is saved in the script trace directory.
Only applicable if _Browser_ is set to _Internet Explorer_.
* *Use 64Bit Webdriver* Select your preferred bitness here. The program
tries the other one in case the preferred one is not available and
generates a warning.

*Options for Microsoft Edge*

* *Pageload Strategy* Edge possesses several options how to wait for a
page to load:
** *Default* not specified
** **Normal W**aits until pages are loaded and _Ready State_ is
_Complete_
** **Eager W**aits until pages are loaded and _Ready State_ is
_Interactive_ or _Complete._
** *None* Doesn’t wait until pages are loaded, returns immediately.

=== Inbound Variables

*Chrome:*

link:#AS_WebSession_P_AdditionalChromArguments[Additional Chrome
arguments]

link:#AS_WebSession_P_AlternativeUserAgentStri[Alternative User Agent
String]

link:#AS_WebSession_WebSessionID[Web Session ID]

link:#AS_WebSession_P_InitialURL[Initial URL]

*Firefox:*

link:#AS_WebSession_P_ProfileName[Profile name]

link:#AS_WebSession_P_Prefer64BitWebdriver[Prefer 64Bit Webdriver]

link:#AS_WebSession_P_AlternativeUserAgentStri[Alternative user agent
string]

link:#AS_WebSession_P_AcceptUntrustedCertifica[Accept untrusted
certificates]

link:#AS_WebSession_P_EnableNativeEvents[Enable native events]

link:#AS_WebSession_P_Port[Port]

link:#AS_WebSession_WebSessionID[Web Session ID]

link:#AS_WebSession_P_InitialURL[Initial URL]

*Internet Explorer:*

link:#AS_WebSession_P_AlternativeUserAgentStri[Alternative user agent
string]

link:#AS_WebSession_P_Use64BitWebdriver[Use 64Bit Webdriver]

link:#AS_WebSession_P_AdditionalOptions[Additional Options]

link:#AS_WebSession_P_ClearBrowserCache[Clear browser cache]

link:#AS_WebSession_WebSessionID[Web Session ID]

link:#AS_WebSession_P_InitialURL[Initial URL]

*MS Edge:*

link:#AS_WebSession_WebSessionID[Web Session ID]

link:#AS_WebSession_P_InitialURL[Initial URL]

=== Outbound Variables

The _Web Session_ Action Steps have no outbound variables.

=== Wizard

The *Reuse Web Session* section and the *General Settings* are identical
for all four web sessions.

image:media\image1.png[Ein Bild, das Text enthält. Automatisch
generierte Beschreibung,width=500,height=218]

The *Reuse Web Session* section defines which web session should be
reused. To enable this, you need the *web session ID,* which you save in
the Workflow-based variables ahead of time.

image:media\image2.png[Ein Bild, das Text enthält. Automatisch
generierte Beschreibung,width=452,height=171]

You can define a name and a description; the value is assigned
automatically. Once you have created the web session ID, you can link it
with the session easily, using the drop-down in the Web Session Wizard.

image:media\image3.png[image,width=317,height=86]

In the script Run Results, you see whether a new web session was created
or a web session ID was used, and in the latter case, which one.

If a web session ID is used that was created with the web session type
Firefox, for example, but is to be continued with a different web
session type, such as a Chrome session, a warning is issued in the
standard case. You can change this response with the *Browser Mismatch*
option**.** You have two options here:

* {blank}
+
____
Warning (default): The Workflow Run is assigned a warning, but continues
running. In this case, the original web session browser is used
automatically.
____
* {blank}
+
____
Error: The Workflow Run ends in an error.
____

The standard response of the browser and the execution are defined in
the *General Settings* area.

You use the *Initial URL* to specify the initial URL of the web page you
want to call. Wenn Sie direkt die Aufrufzeit Ihrer Webseite vermessen
wollen, sollten Sie about:blank stehen lassen und Ihre Webseite per
_Navigate Action Step_ ansteuern. Dieses _Navigate_ können Sie dann per
Stopwatch messen.

If another web session that was created with the same web session ID is
opened, the initial URL from that session is ignored.

Falls _Image search_ _Action Steps_ in der _Web Session_ verwendet
werden, empfehlen wir die Option *Start maximized*. Dadurch sind die
Elemente immer an einer definierten Stelle.

*Open Browser Wizard when done* If this option is enabled, the Browser
Wizard is opened when the Web Session Wizard is closed.

*Keep out mouse, move it to*: In some cases, the mouse could hide
certain buttons or texts. You use this option to define where you want
the mouse to move to:

image:media\image4.png[Ein Bild, das Text enthält. Automatisch
generierte Beschreibung,width=288,height=70]

You can also define whether or not you want to execute this action after
every Action Step.

The *Browser specific settings* area differs between all four web
sessions.

*Chrome:*

image:media\image5.png[image,width=513,height=91]

Siehe link:#AS_WebSession_P[Properties].

*Firefox:*

image:media\image6.png[Ein Bild, das Text enthält. Automatisch
generierte Beschreibung,width=522,height=223]

Firefox saves the users’ personal information in a profile. You can
create additional profiles in the Firefox profile manager. Under
*Profile name*, specify which profile you want to use to execute the web
session.

See also link:#AS_WebSession_P[Properties].

*Internet Explorer:*

image:media\image7.png[Ein Bild, das Text enthält. Automatisch
generierte Beschreibung,width=526,height=135]

See link:#AS_WebSession_P[Properties].

*MS Edge:*

image:media\image8.png[image,width=530,height=139]

*Page load strategy* defines the system behavior when loading a page.
The following options are available: Default, Normal, Eager, and None.

See also link:#AS_WebSession_P[Properties].

=== Activity Workflow overlapping Web Session

In X1 Design Studio Version 2021.1, you can use web sessions across
workflows within a business process.

It is now possible to open a web session in an initial workflow, perform
a web login there, and then process this workflow in a different,
independent workflow.

The web session ID lets you use the session globally within the
workflow. To pass the web session on to another workflow within a
business process, the web session ID must be defined as an activity
parameter (and not as a workflow-based variable).

To do this, proceed as follows:

* {blank}
+
____
Create a web session ID in the activity parameter.
____
* {blank}
+
____
Link the web session ID with the workflow. You will find the web session
ID in the _Activity Parameters_ Action Step, which you placed in the
Workflow Initialization Block beforehand.
____
* {blank}
+
____
You link the web session ID in the corresponding web session.
____
* {blank}
+
____
If you want the web session to be closed at a later point in the
workflow, use the _Close Web Session_ Action Step.
____

=== Closing a Web Session

There are three different variants for closing a web session:

* {blank}
+
____
The closing of the browser is already contained in the web session,
which means the session is closed automatically when session execution
is complete. This only applies if the web session is *not* linked with a
web session ID.
____
* {blank}
+
____
If the web session block is linked with a web session ID, the browser
remains open. The web session – or, more accurately, the browser – is
not closed until the end of the workflow. This only applies if the web
session was linked using a workflow-based variable. If it is linked with
an activity parameter, in contrast, the web session remains active –
that is, the browser remains open – and can be used further (see the
chapter _Cross-Activity Workflow Web Session_).
____
* {blank}
+
____
The Action Step _Close Web Session_ gives you the additional option of
closing the session at a specific point in the Workflow.
____
