//used in:
// toolbox-mail-operations-mail-session-outlook-with-oauth
// toolbox-variable-handling-credentials-for-oauth

// tag::common-oauth-properties[]
* *OAuth Authentication* Settings
// tag::pin-custom-settings[]
** *Pin OAuth Settings*
+
Select this option to specify OAuth credentials created with the xref:toolbox-variable-handling-credentials-for-oauth.adoc[Credentials for OAuth] Action Step.
** *Use custom settings*
+
Select this option to specify custom OAuth credentials for this Action Step.
// end::pin-custom-settings[]
+
** *E-Mail Provider*
+
Select either *Outlook* or *Google*.
** *Auth Endpoint*
+
The URL for the OAuth authentication endpoint. Defaults to the following values, depending on the selected provider: 
+
*** *Outlook*: `+https://login.microsoftonline.com/common/oauth2/v2.0/authorize+`
*** *Google*: `+https://accounts.google.com/o/oauth2/v2/auth+`
+
** *Token Endpoint*
+
The URL for the OAuth Refresh Token process. Defaults to the following values, depending on the selected provider: 
+
*** *Outlook*: `+https://login.microsoftonline.com/common/oauth2/v2.0/token+`
*** *Google*: `+https://www.googleapis.com/oauth2/v4/token+`
+ 
** *Client ID*
+
To authenticate with the OAuth Host, an Azure application must be defined in your space. This Azure application has an ID, that is unique in the entire OAuth Host space and it allows users to explicitly grant or revoke access for this Azure application to their accounts. For more information on how to create this Azure application for Outlook, visit https://learn.microsoft.com/en-us/azure/active-directory/develop/quickstart-register-app[Quickstart: Register an application with the Microsoft identity platform^].
** *Client Secret*
+
Allows RPA Builder to prove to the OAuth Host that it received permission to access user accounts on behalf of the registered Azure application. Without this permission, authentication is not possible.
** *Redirect URI*
+
The URI to which the OAuth Host redirects after the user completes the authentication attempt. This redirect URI must be registered with the Azure application. If the entered redirect URI matches one of the registered URIs, the OAuth Host allows the authentication.
** *Scopes*
+
Defines which permissions the user grants to the Azure application. By default, RPA Builder requests the following permissions depending on the selected provider:

*** *Outlook*
+
**** *`offline_access`*
+
(*Required*) Enables access via a refresh token, which you can use to repeatedly log in to the email services without requiring user interaction each time.
**** *`+https://outlook.office.com/IMAP.AccessAsUser.All+`*
+
(*Required* when using IMAP) Enables reading and moving emails from the Outlook IMAP server.
**** *`+https://outlook.office.com/POP.AccessAsUser.All+`*
+
(*Required* when using POP3) Enables reading emails from the Outlook POP3 server.
**** *`+https://outlook.office.com/SMTP.Send+`*
+
(*Required* when using SMTP) Enables sending emails from the Outlook SMTP server.
**** *`openid email`*
+
Enables RPA Builder to automatically detect the email account used to log in to the Azure application. If this scope is omitted, you must provide an email in the wizard.
+
*** *Google*
+
**** *`+https://mail.google.com/+`*
+
Enables RPA Builder to read, compose, send, and permanently delete emails from your Gmail account.
+
** *Save data to generate Tokens via the Tools menu*
+
Saves the current data for further use when <<generate-oauth-token, Generating an OAuth Refresh Token>>.
+
** *Email address*
+
The email address populates automatically if RPA Builder detects it from the authentication attempt. If the *openid email* scope is omitted, you must provide an email address manually.

// end::common-oauth-properties[]