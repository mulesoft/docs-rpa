= Credentials for OAuth

The Credentials for OAuth action step enables you to set up your OAuth credentials one time and then reference them in Action Steps that support OAuth Authentication. You can create a set of tokens that don't rely on a user password to authenticate with the email server and then use the token to repeatedly log in to the services without asking for the user's password again.

[[properties]]
== Properties

include::partial$oauth-credentials-properties.adoc[tags=common-oauth-properties;!pin-custom-settings]

== Inbound Variables

* *OAuth Host Address*
+
The host address used to get the credentials.
* *OAuth Client ID*
+
The Azure application client ID.
* *Client Secret*
+
The Azure application client secret.
* *Redirect Uri*
+
The URI to which the OAuth Host redirects after the user completes the authentication attempt.
* *Scopes*
+
The set of permissions the user grants to the Azure application.
* *E-mail Address*
+
The email address.
* *Refresh Token*
+
The OAuth refresh token.

== Outbound Variables

* *Credentials of OAuth*

== Wizard

image:credentials-for-oauth.png[The Credentials for OAuth Wizard, 60%, 60%]

Follow these steps to authenticate with your credentials:

. Complete the *OAuth Authentication* configuration by specifying the required properties.
+
Refer to <<properties, Properties>> for a description of each property.
. Click *Authenticate*.
+
This step starts the authentication process with the OAuth Host, which opens the login page in your default browser.
. In the OAuth Host’s login page, complete the login process.
. Close the browser.

After completing the last step, the wizard shows that you are authenticated:
image:email-outlook-authentication.png[The Logged in confirmation message in the authentication settings window, 50%, 50%]

[[generate-oauth-token]]
=== Generating an OAuth Refresh Token
// TODO update this with the outlook/google selector
To generate and configure a refresh token:

. In the *Tools* menu, select *Generate OAuth Refresh Token*.
+
image:generate-oauth-token.png[The Generate OAuth Refresh Token options in the Tools menu, 40%, 40%]
. Complete the *OAuth Token Creator* form that appears.
+
image:generate-token-form.png[The OAuth Token Creator Form, 60%, 60%]
+
If you already configured the Credentials for OAuth Action Step details and clicked the *Save data to generate Tokens via the Tools menu* button, the data automatically populates with the last data you entered in the wizard.
. Click *Authenticate*.
. Click *Copy Token to Clipboard*.
. Paste the token in an alphanumeric Server Based Variable.
. Pin the variable to the field *Refresh Token* in the *Credentials for OAuth* wizard.
+
You can also pin the other values from the *OAuth Token Creator*.
+
By using a Server Based Variable you don’t need to upload a new version of your Workflow to RPA Manager if your token expires or your user gets logged out of Microsoft. In this case, regenerate the refresh token for the same user with the *OAuth Token Creator* and update the assigned Server Based Variable on RPA Manager.

== See Also

* xref:toolbox-mail-operations-mail-session-outlook-with-oauth.adoc[Mail Session (Outlook with OAuth)]
* https://azure.microsoft.com/en-us/[Azure^]
* https://learn.microsoft.com/en-us/exchange/client-developer/exchange-web-services/how-to-authenticate-an-ews-application-by-using-oauth[Authenticate an EWS application by using OAuth^]
* https://learn.microsoft.com/en-us/exchange/client-developer/legacy-protocols/how-to-authenticate-an-imap-pop-smtp-application-by-using-oauth[Authenticate an IMAP, POP or SMTP connection using OAuth^]
