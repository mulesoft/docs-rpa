= Preparing Automations

Create and document the environment for the automation of processes.

== Before You Begin

* Ask an administrator to xref:usermanagement-manage.adoc#assign-privileges-to-a-user[assign you the needed privileges]:
+
[cols="1,2"]
|===
|*Action* |*Required Privileges*

|Open the *Process Automation* module
|Process Automation Open

|Create and change global variables and credentials that can be used in the test phase
|Global Variables Create for Test phase, Global Variables Edit for Test phase

|Create and change global variables and credentials that can be used in the production phase
|Global Variables Create for Production phase, Global Variables Edit for Production phase

|Delete global variables and credentials
|Global Variables Delete

|Create, change, and delete process applications
|Application Create, Application Edit, Application Delete

|===
* If you have access to an Amazon Web Services (AWS) account and want to create AWS credentials for xref:rpa-builder::toolbox-aws-document-processing.adoc[RPA Builder - Document Processing with AWS], follow the instructions in https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-quickstart.html[AWS configuration basics^].
* If you have access to a Microsoft Azure account and want to create OAuth credentials for xref:rpa-builder::toolbox-mail-operations-mail-session-outlook-with-oauth.adoc[RPA Builder - Mail Session (Outlook with OAuth)], create an application for Outlook, https://learn.microsoft.com/en-us/exchange/client-developer/exchange-web-services/how-to-authenticate-an-ews-application-by-using-oauth[authenticate an EWS application by using OAuth^], and https://learn.microsoft.com/en-us/exchange/client-developer/legacy-protocols/how-to-authenticate-an-imap-pop-smtp-application-by-using-oauth[authenticate an IMAP, POP, or SMTP connection using OAuth^].
* If you want to use RPA Builder to xref:rpa-builder::toolbox-variable-handling-credentials-for-oauth.adoc#generating-an-oauth-refresh-token[generate a refresh token for your OAuth credentials], ask an administrator to xref:usermanagement-manage.adoc#assign-users-rpa-builder-access[assign you RPA Builder access].

== Prepare Projects

Project managers organize projects into categories. You create a set of categories for them to choose from.

You list available applications and assign them to bots that can access them. Citizen technologists assign required applications to processes. A member of the process team can deploy a process on a bot that has assigned the required processes.

You create global variables and credentials for values that are the same in multiple processes and that frequently change. This way, you can reduce the time involved and the error rate in the maintenance of the processes. A member of the process team can link global variables and credentials anywhere that a globe symbol is displayed.

Learn how to manage <<manage-globalvariables, global variables>> and <<manage-credentials, credentials>>.

Learn how to link global variables and credentials in a xref:processautomation-deploy.adoc#test-configuration-link-globals[test] and xref:processautomation-deploy.adoc#production-configuration-link-globals[production] configurations.

[[manage-categories]]
=== Manage Categories

Project managers organize projects into categories. A category describes the environment of a process in a few keywords, for example `Customer Support Mystical University` or `Finance`.

A project can only belong to a single category. First, create a standard category, so the process team can start with process automation quickly. They can change the category of a process later. After they have automated the first few projects, create an archive category to move the completed projects there.

==== Create a Category

Create categories for the organization of processes:

. Open the *Process Management* view of the *Process Automation* module.
. Click *Create*.
. Enter a name in the *Create a category* window.
. Click *OK*.

==== Edit a Category

Edit a category to render its name more precisely:

. Open the *Process Management* view of the *Process Automation* module.
. Click the *Edit* icon image:edit-icon.png[pen-to-square symbol,1.5%,1.5%] on the panel of the category you want to edit.
. Change the name in the *Edit the category* window.
. Click *OK*.

==== Remove a Category

Remove categories that are no longer needed. You can only remove categories that do not contain processes:

. Open the *Process Management* view of the *Process Automation* module.
. Click the the *Remove* icon image:delete-icon.png[trash symbol,1.5%,1.5%] on the panel of the category you want to delete.

[[manage-applications]]
=== Manage Process Applications

In the *Process Applications* view, you list all applications required for the execution of processes.

In the *Process Management* view, the project manager xref:myrpa-start.adoc#required-process-applications[assigns required applications to a process] at process creation or phase transition.

In the module *Bot Management*, the administrator xref:botmanagement-manage.adoc#bot-assign-servicetimes-applications[assigns required applications to bots] that can execute them. Bots can execute all applications installed on their computer.

Applications are not available during down-times or while deactivated. A member of the process team can deploy a process on a bot that has assigned the required processes. If an application becomes non-available, the bot completes running processes using that application and restarts them when the downtime or deactivation period has ended.

Learn how to xref:botmanagement-manage.adoc#bot-assign-servicetimes-applications[assign required applications to a bot].

You can deploy a process on a bot that has assigned the required applications.

Specify a downtime in the time zone in which it occurs. If the bot that you assign the downtime to is installed on a computer that uses a different time zone, the downtime interval is converted to the bot’s time zone. If you assign the application to multiple bots in different time zones, all bots pause executing processes that use that application simultaneously. The time intervals might change, depending on daylight saving time.

For example, if you specify a downtime that starts at 1:30 AM and ends at 5:30 AM in Tokyo time (JST (UTC +9)) and the bot is installed on a computer in San Francisco (PST (UTC -8)), the bot does not execute processes that use the application between 8:30 AM and 12:30 PM in San Francisco time.

==== Create a Process Application

Create one entry for each application required for the execution of processes.

To avoid confusion, append the name of the time zone to the name of the application or the downtime. For example, name your application `Words - Tokyo` and your downtime `Electrical Power Outage Tokyo`.


. Open the *Process Applications* view of the *Process Automation* module.
. Click *Create*.
. [[form-create-process-applications]] Complete the form *Create a new application*:
+
* *Time Zone*:
+
Time zone for defining downtimes.
+
Specify a downtime in the time zone in which it occurs. If the bot that you assign the downtime to is installed on a computer that uses a different time zone, the downtime interval is converted to the bot’s time zone. If you assign the application to multiple bots in different time zones, all bots pause executing processes that use that application simultaneously. The time intervals might change, depending on daylight saving time.
+
For example, if you specify a downtime that starts at 1:30 AM and ends at 5:30 AM in Tokyo time (JST (UTC +9)) and the bot is installed on a computer in San Francisco (PST (UTC -8)), the bot does not execute processes between 8:30 AM and 12:30 PM in San Francisco time.
+
To avoid confusion, append the name of the time zone to the name of the downtime. For example, name your downtime `Electrical Power Outage Tokyo`.
+
* *Downtimes*
+
Click *Create* to add a downtime to the application.
. Click *Save*.

==== Edit an Application

Edit an application to change its data or down-times:

. Open the *Process Applications* view of the *Process Automation* module.
. Click *Create*.
. Edit the form *Edit the application*.
+
For an explanation of the properties, see  <<form-create-process-applications, *Create an Application*>>.
. Click *Save*.

==== Deactivate or Activate a Process Application

Deactivate an application if it is temporarily not available and you don't know when it will be available again.

Use down-times to schedule maintenance and planned downtimes. Deactivation periods are not added to the list of down-times.

Applications are not available during down-times or while deactivated. A member of the process team can deploy a process on a bot that has assigned the required processes. If an application becomes non-available, the bot completes running processes using that application and restarts them when the downtime or deactivation period has ended.

If an application is not available, deactivate it:

. Open the *Process Applications* view of the *Process Automation* module.
. Click the *Deactivate* icon image:deactivate-icon.png[toggle-on symbol,1.5%,1.5%] on the panel of the application you want to deactivate.

RPA Manager displays an *Inactive* label beneath the logo of the application.

If a deactivated application becomes available again, activate it:

. Open the *Process Applications* view of the *Process Automation* module.
. Click the *Activate* icon image:activate-icon.png[toggle-off symbol,1.5%,1.5%] on the panel of the application you want to activate.

RPA Manager displays an *Active* label beneath the logo of the application.

==== Remove a Process Application

Remove an application if it is no longer available:

. Open the *Process Applications* view of the *Process Automation* module.
. Click the the *Remove* icon image:delete-icon.png[trash symbol,1.5%,1.5%] on the panel of the application you want to remove.
. Confirm the removal.

RPA Manager removes the application from all processes and bots to which it was assigned to.

== Prepare Deployment

Use global variables or credentials for values and login data that are the same in multiple processes and that frequently change. This way you can reduce the time involved and the error rate in the maintenance of your processes.

A member of the process team can link global variables or credentials anywhere that a globe symbol is displayed. A link symbol indicates an existing link. You can change and delete links.

[[manage-globalvariables]]
=== Manage Global Variables

Create global variables for values that are the same in multiple processes and that frequently change. This way you can reduce the time involved and the error rate in the maintenance of the processes.

The RPA developer defines xref:rpa-builder::toolbox-variable-handling-activity-parameters.adoc[activity parameters for a process in RPA Builder]. When members of the process team link global variables or credentials in a run configuration, they overwrite the initial value of the activity parameter.

Process team members can link global variables to activity parameters in automations:

* xref:processautomation-deploy.adoc#test-configuration-link-globals[Linkable Activity Parameters in Test Configurations]
* xref:processautomation-deploy.adoc#production-configuration-link-globals[Linkable Activity Parameters in Production Configurations]

Editing or deleting a global variable affects all configurations that use the variable.

Check the usage of a variable before changing or deleting it.

==== Create a Global Variable

A global variable consists of a name, description, type, and value. Team members can link them to activity paramters in the test or the production phase. 

Use descriptive names for global variables and only use the variables in an appropriate context. If, for example, the number 42 happens to be both the number of employees in your company and the answer to a different question, then create two global variables (for example, `number_employees` and `answer`).

. Open the *Global Variables* view of the *Process Automation* module.
. Click *Create*.
. [[form-create-globalvariable]] Complete the form *Create a New Global Variable*:
* *Phase affiliation*:
+
Phases in which the variable is permitted to be deployed. When you create or change the variable, your individual privileges determine which phases you can select:
+
** *Test*:
+
The variable can be deployed in the test phase.
+
** *Production*:
+
The variable can be deployed in the production phase.

* *Type*:
+
Type of the global variable. The type of variable determines where it can be used. The original value defined in RPA Builder is typed. Select one of the following types:
+
** *Integer*:
+
An integer number.
** *Alphanumeric*:
+
A character string.
** *Boolean*:
+
A logical value. Set the checkmark in the *Value* checkbox for the value `true` or remove the checkmark for the value `false`.
** *Float*:
+
A floating-point number.
** *Coordinate*:
+
Combination of two integer values for an X-Y coordinate. Use global coordinates, for example, as an offset to determine a screen coordinate.
* *Value*:
+
You can only enter values of the specified type.

==== Check the Usage of a Global Variable

Before editing a global variable, check its usage to avoid inadvertent side-effects:

. Open the *Global Variables* view of the *Process Automation* module.
. Click the *Usage* icon image:usage-icon.png[binoculars symbol,1.5%,1.5%] in the table row of the global variable you want to check.

A window with a table shows you the configurations in which the global variable is used.

====  Edit a Global Variable

Edit a global variable to change its name or value. You cannot change the type of a global variable. Check the usage of the variable first to avoid inadvertent side-effects.

. Open the *Global Variables* view of the *Process Automation* module.
. Click the *Edit* icon image:edit-icon.png[pen-to-square symbol,1.5%,1.5%] in the table row of the global variable you want to edit.
. Change data in the form *Edit the Global Variable*.
+
For an explanation of the properties, see  <<form-create-globalvariable, *Create a Global Variable*>>.
. Click *Save*.

The variable is changed everywhere it is used.

==== Delete a Global Variable

Delete global variables that are no longer needed. You cannot delete variables linked in configurations.

. Open the *Global Variables* view of the *Process Automation* module.
. Click the *Delete* icon image:delete-icon.png[trash symbol,1.5%,1.5%] in the table row of the global variable you want to delete.
. Confirm the deletion.

[[manage-credentials]]
=== Manage Credentials

Credentials store login data for applications or web services. Passwords are encrypted. Only affiliated users can view, edit, and use the credentials.

You can create the following types of credentials:

* *AWS Credentials*
+
For accessing Amazon Web Services to use them with xref:rpa-builder::toolbox-aws-document-processing.adoc[RPA Builder - Document Processing with AWS]
* *OAuth Credentials*
+
For accessing the Microsoft Outlook email application via Microsoft Azure with xref:rpa-builder::toolbox-mail-operations-mail-session-outlook-with-oauth.adoc[RPA Builder - Mail Session (Outlook with OAuth)]
* *User Account Credentials*
+
For accessing all other kinds of applications

Affiliated process team members can link global credentials to activity parameters in automations:

* xref:processautomation-deploy.adoc#test-configuration-link-globals[Linkable Activity Parameters in Test Configurations]
* xref:processautomation-deploy.adoc#production-configuration-link-globals[Linkable Activity Parameters in Production Configurations]

Editing or deleting a credential affects all configurations that use the credential.

Check the usage of a credential before changing or deleting it.

==== Create Credentials

Create credentials with which a bot can login to an external application during process runs:

. Open the *Credential Pool* view of the *Process Automation* module.
. Click *Create*.
. [[form-create-credential]] Complete the form *Create a New Credential*:
* [[form-create-credential-useraffiliation]] *User affiliation*:
+
Click to choose users that may view, edit and use the credential. Add yourself to be able to view, edit, and use the credential, too.
* *User group affiliation*:
+
Click to choose user groups whose users may view, edit and use the credential.
* *Phase affiliation*:
+
Phases in which the credential can be deployed. When you create or change the credential, your privileges determine which phases the user can select:
+
** *Test*:
+
The credential can be deployed in the test phase.
+
** *Production*:
+
The credential can be deployed in the production phase.

* *Type*:
+
Type of the global credential. The type of credential determines where you can use it. The original value defined in RPA Builder is typed. Select one of the following types:
+
** *AWS Credentials*:
+
Use this credential for accessing Amazon Web Services. Fill in the client ID, client secret, and region. Using a session token is optional.
** *OAuth Credentials*
+
Use this credential for accessing the Microsoft Outlook email application via Microsoft Azure.
+
*** *OAuth Host*:
+
The host address used to get the credentials. The default address for Outlook services is `https://login.microsoftonline.com/common/oauth2/v2.0/`. This address might change if the customer uses a self hosted service.
*** *Client ID*:
+
To authenticate with the OAuth Host, an Azure application must be defined in the customer's space. This Azure application has an ID that is unique in the entire OAuth Host space and that allows users to explicitly grant or revoke access for this Azure application to their accounts.
+
For more information about how to create this Azure application for Outlook, see https://learn.microsoft.com/en-us/azure/active-directory/develop/quickstart-register-app[Quickstart: Register an application with the Microsoft identity platform^].
*** *Client Secret*
+
This secret enables RPA Manager to prove to the OAuth Host that it received the permission to access user accounts on behalf of the registered Azure application. Without it, the authentication is not possible.
*** *Redirect URI*
+
The URI to which the OAuth Host redirects after the user completes the authentication attempt. This redirect URI must be registered with the Azure application. The OAuth Host allows the authentication only if the entered redirect URI matches one of the registered URIs.
*** *Scopes*
+
The scopes define which permission the user grants to the Azure application. Grant the following permissions:
+
**** `offline_access`
+
(*Required*) Enables access via a refresh token, which you can use to repeatedly log in to the mail services without requiring user interaction each time.
**** `https://outlook.office.com/IMAP.AccessAsUser.All`
+
(*Required* when using IMAP) Enables reading and moving emails from the Outlook IMAP server.
**** `https://outlook.office.com/POP.AccessAsUser.All`
+
(*Required* when using POP3) Enables reading emails from the Outlook POP3 server.
**** `https://outlook.office.com/SMTP.Send`
+
(*Required* when using SMTP) Enables sending emails from the Outlook SMTP server.
**** `openid email`
+
Enables RPA Manager to automatically detect the email account used to log in to the Azure application. If this scope is omitted, you must provide an email in RPA Builder.
+
*** *E-Mail Address*
+
Email address for accessing Outlook.
*** *Refresh Token*
+
Refresh token generated with the authentication properties.
+
Learn how to xref:rpa-builder::toolbox-variable-handling-credentials-for-oauth.adoc#generating-an-oauth-refresh-token[generate an OAuth refresh token with RPA Builder].
** *User Account Credentials*
+
Use this credential for accessing all other kinds of applications. Fill in the the username and password.
. Click *OK*.

==== Check the Usage of a Credential

Before editing a credential, check its usage to avoid inadvertent side-effects.

. Open the *Credential Pool* view of the *Process Automation* module.
. Click the *Usage* icon image:usage-icon.png[binoculars symbol,1.5%,1.5%] in the table row of the credential you want to check.

A window with a table shows you the configurations in which the credential is used.

====  Edit a Credential

Edit a credential to change its data. You cannot change the type of a credential. You can only edit a credential if you belong to the <<form-create-credential-useraffiliation, affiliated users>>.

Check the usage of the credential first to avoid inadvertent side-effects:

. Open the *Credential Pool* view of the *Process Automation* module.
. Click the *Edit* icon image:edit-icon.png[pen-to-square symbol,1.5%,1.5%] in the table row of the credential you want to edit.
. Change data in the form *Edit the Credential*.
+
The properties are explained in the form <<form-create-credential, *Create a New Credential*>>.
. Click *Save*.

The credential is changed everywhere it is used.

==== Delete a Credential

Delete credentials that are no longer needed. You cannot delete credentials linked in configurations.

. Open the *Credential Pool* view of the *Process Automation* module.
. Click the *Delete* icon image:delete-icon.png[trash symbol,1.5%,1.5%] in the table row of the credential you want to delete.
. Confirm the deletion.

== See also

* xref:index.adoc[RPA Manager]
* xref:processautomation-overview.adoc[Process Automation]
