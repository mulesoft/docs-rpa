# Interacting with a Screen of a Legacy Application

// number the headings to correspond to the numbered list of steps
:sectnums:

With the order ID you can now get the corresponding tracking number from the legacy system:

. Run your legacy application.
. Search for the word `Order-ID` on the screen, click in the edit field next to it, enter the order ID and click *Search*.
. If there is a result, copy the tracking number to the activity parameter and set the gateway variable `is_orderid_found` to true. 
. If there is no result, set the gateway variable `is_orderid_found` to false.

image::usecase-legacysystem-screeninteraction.png[Overview of the workflow of the activity for the searching of the order ID with screen interactions. The number of the steps are contained in frames.]

## Run a Legacy Desktop Application

To run the legacy desktop order tracking application, you select the path to the executable file in the *Run program* Action Step. You set the start mode of the application to `Maximized` to open the application in a maximized window. This ensures that the elements of the UI are always in the same position on the screen, which is important because you later use Action Steps that work with screen coordinates. You select `Wait for Window to appear` and specify the window title to ensure that the following Action Steps won't return an error because the window isn't there yet.

image::usecase-legacysystem-screeninteraction-run.png[]

## Enter Text Into a Screen Element and Click a Button

To search for the tracking number, you have to enter the order ID in the search field and click the search button.

To find the search field, you need to find the word `Order ID` next to it on the application screen first. You use the *Search Pattern* Action Step to capture and compare the pattern:

image::workflow-capturepattern.png[]

image::usecase-legacysystem-screeninteraction-searchpattern.png[]

Finding the pattern returns a coordinate that you use in the next step to determine where to input the order ID. Use *Mouse Action* to click into the search field next to the label `Order ID`:

image:usecase-legacysystem-screeninteraction-mouseaction.png[]

The search field now has the focus, so you can just enter the order ID with a simulated keyboard. Instead of recording key strokes, you use the Activity Parameter `order_id` with the *Enter String* Action Step to copy the Order ID into the field:

image::usecase-legacysystem-screeninteraction-enterstring.png[]

You use *Mouse Action* again to start the search. To determine the position of the search button to click, you reuse the location of the `Order id` pattern to record the click position.

image::usecase-legacysystem-screeninteraction-mouseaction-clickbutton.png[]

## Check the Results

You know, that the search is successful, when there is a result listed. As you can see on xref:automation-usecase-legacysystemdataextraction.adoc#trackingsystem-allentries-image[the screen], the tracking number should be listed in the column of the same name, so you search for that column first, using `Tracking No.` as the search pattern:

image::usecase-legacysystem-screeninteraction-searchpattern-text.png[]

Because it might be that the order has no corresponding tracking number in the system and you don't want to falsely return the initial value of the variable as tracking number, you check this case first.

In the *DoAction*, which works like a try element, you check if the result list is empty. As you can see on xref:automation-usecase-legacysystemdataextraction.adoc#trackingsystem-noentries-image[the screen], in case of no results, an up arrow is shown directly below the empty space where the results should have been.

You use the *Search Pattern* Action Step to search for the arrow up symbol and limit the search area to the space directly below the column name.

If the pattern is not found - which in your case means that the system found a corresponding tracking number - *Search Pattern* returns an error. To continue with the workflow you need to force an OK state then, which you do in the *OnError* section.

image::usecase-legacysystem-screeninteraction-searchpattern-relatedcoordinates.png[]

image::workflow-searchforemptylist-searcharea.png[]

As you can see on xref:automation-usecase-legacysystemdataextraction.adoc#trackingsystem-resultentry-image[the screen],


...
// Turn off section numbering
:sectnums!:

## Next Activity

* xref:automation-usecase-legacysystemdataextraction.adoc[]

## See Also

// Features of RPA Manager and RPA Builder used in this topic
* xref:rpa-builder::.adoc[RPA Builder Action Step: ]
* xref:rpa-builder::.adoc[RPA Builder Action Step: ]
* xref:rpa-builder::.adoc[RPA Builder Action Step: ]
