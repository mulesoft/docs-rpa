# Implement the tracking number extraction activity


With the order ID you can now get the corresponding tracking number from the legacy system:

. Import all three Activity Paramters. The order ID is already filled with the value extracted in the last Activity.
. Run your legacy application.
. Search for the word `Order-ID` on the screen, click in the edit field next to it, enter the order ID and click *Search*.
. If there is no result, set the gateway variable `is_orderid_found` to false.
. If there is a result, copy the tracking number to the activity parameter and set the gateway variable `is_orderid_found` to true. 

image::workflow-extractdatafromscreen.png[]

## Run the Legacy Application

To run a Desktop application, you can use the *Run program* Action Step:

* You enter the path to the executable file or select it in a file browser
* You set the start mode of the application to `Maximized`. This opens the application in a maximized window and which means you can be sure that the elements of the UI are always on the same position on the screen, which is important for later Action Steps that work with screen coordinates.
* You select `Wait for Window to appear` and specify the window title to ensure that the following Action Steps won't return an error because the window is not yet there.

image::workflow-runprogram.png[]

## Search the Tracking Number ID

To search for the tracking number, you have to enter the order ID in the search field and click search.

To find the search field, you need to find the the word `Order ID` on the application screen first. For this, you use the *Search Pattern* Action Step to capture and compare the pattern:

image::workflow-capturepattern.png[]

image::workflow-searchpattern.png[]

This returns a coordinate which you can use in the next step to determine where to input the order ID.

Use *Mouse Action* to click into the search field:

image::workflow-clickinsearchfield.png[]

The search field now has the focus, so you can just enter the order ID with a simulated keyboard. Instead of recording key strokes, you use the Activity Paramter `order_id` with the *Enter String* Action Step to copy the Order ID into the field:

image::

Then Mouse Action again to start the search:

image::



## Check the Results

You know, that the search is succesful, when there is a result listed.
....