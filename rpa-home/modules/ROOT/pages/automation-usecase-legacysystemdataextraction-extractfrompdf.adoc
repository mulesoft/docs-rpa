# Implement the order ID extraction activity
// number the headings to correspond to the numbered list of steps
:sectnums:

First, you need to find the order ID in the PDF.

As you can see in xref:automation-usecase-legacysystemdataextraction.adoc#confirmationletter-image[the image of the order confirmation letter], the order ID is always listed in a table next to the entry 'Order ID'. 
// Do we need an image of that part of the letter here?
You can use this information to implement the workflow containing the following steps:

. Copy the content of the order confirmation to a text file.
. Read the text file line by line to find the one containing the order ID.
. Check if the order ID is found
. Cut the order ID out from the text and store it in an activity parameter.

image::usecase-legacysystem-extractformpdf-workflow-overview.png[Overview of the workflow of the activity for the extraction of the order ID from a PDF. The number of the steps are contained in frames.]

## Copying Text From a PDF to a Text File
// Do we need to write Action Step or AS (and variable etc) each time we mention one?
To open the PDF, you use *Read PDF file*. Then you use the returned `ReadText` as input for *Write to Text File* to save the content as text file on your computer.

image::usecase-legacysystem-extractformpdf-workflow-pdftotxt.png['The part of the workflow that copies the text from a PDF to a text file is framed. The wizard for the Write To Text File action step is open with a frame around the Pin Variable containing the text extracted from the PDF by the previous action step.']

The following image shows the result of storing the text content. Each line of the PDF has a corresponding line in the text file. Images are omitted.

// no alt text because description of image is contained in paragraph
image::extractorderid-workflow-resultpdftotxt.png['', 75%]

## Looping Over All Lines of a Text File

To loop over all lines of the text file, you first need to count the number of lines by reading the entire file using the Action Step *Read from Text File*. You use the returned `line count` as the maximum value for the iteration counter. The counter doubles as the number of the line to read with *Read from Text File* in each iteration. 

image::usecase-legacysystem-extractformpdf-workflow-loopovertextfilelines.png['The part of the workflow that shows the loop in which the text is read line by line is framed. The wizards for the Action Steps Loop and Read From Text File are open showing the used Pin Variables Line Count and Iteration']

## Checking a Case and Catching Errors

Since you don't know which line contains the order id, you use *Select Case* to differ between the two possibilities: In case you found the order id, you cut it out of the text and store it in the activity parameter `order_id`. If you didn't, which happens in each other line, you still want to complete the loop and the workflow and use *Force OK State* to avoid returning an error.

Your criteria for deciding whether you found the order id is that the string `Oder ID` is part of the current line.


image::usecase-legacysystem-extractformpdf-workflow-checkcaseandproceed.png['']

## Retrieving a Substring and Saving it to a Variable

Since you know that the order ID is found after the text `Order ID `, you can simply remove these first nine characters from the current line (which contains the substring `Order ID`). The remaining string is the order ID, which you store in the Activity Parameter of the same name.

For this purpose you use and configure the follwing Action Steps:

. *String Operations*:
+
* Current line as Pin variable
* `Trim left (remove first characters)`
* `9`
. *Set Variable*:
+ 
* Pin Activity Parameter
* Pin Result of String Operation

image::workflow-cutsubstringoutoftext.png['']

// Turn off section numbering
:sectnums!:

## Next Activity

* xref:automation-usecase-legacysystemdataextraction-extractfromscreen.adoc[Implement the tracking number extraction activity]

## See Also

// Links to RPA Builder docs used elements